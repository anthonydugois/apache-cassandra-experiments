bindings:
  seq_key:
    Pad("0", TEMPLATE(keysize,16));
    ToString() -> String
  seq_value:
    SaveLong("id");
    TEMPLATE(valuesizedist,);
    ToLong() -> long;
    SaveLong("size");
    Load("id") -> long;
    CharBufImage("a-zA-Z0-9", 1000000, Load("size") -> long);
    ToString() -> String
  seq_value_size:
    TEMPLATE(valuesizedist,);
    ToLong() -> long
  rw_key:
    TEMPLATE(keydist,);
    Pad("0", TEMPLATE(keysize,16));
    ToString() -> String
  rw_value:
    SaveLong("id");
    Hash();
    TEMPLATE(valuesizedist,);
    ToLong() -> long;
    SaveLong("size");
    Load("id") -> long;
    CharBufImage("a-zA-Z0-9", 1000000, Load("size") -> long);
    ToString() -> String

blocks:
  csv-freqs:
    ops:
      write-row:
        stmt: |
          {rw_key}
  csv-sizes:
    ops:
      write-row:
        stmt: |
          {seq_key},{seq_value_size}
  schema:
    params:
      timeout: 30.0
    ops:
      create-keyspace:
        type: simple
        stmt: |
          CREATE KEYSPACE IF NOT EXISTS TEMPLATE(keyspace,baselines)
          WITH REPLICATION = {'class': 'SimpleStrategy', 'replication_factor': TEMPLATE(rf,1)}
          AND DURABLE_WRITES = true;
      create-table:
        type: simple
        stmt: |
          CREATE TABLE IF NOT EXISTS TEMPLATE(keyspace,baselines).TEMPLATE(table,keyvalue) (
            key text,
            value text,
            PRIMARY KEY (key)
          ) WITH speculative_retry = 'NONE' AND compaction = {'class': 'LeveledCompactionStrategy'};
  rampup:
    params:
      cl: LOCAL_ONE
      timeout: 10.0
    ops:
      rampup-insert:
        type: prepared
        stmt: |
          INSERT INTO TEMPLATE(keyspace,baselines).TEMPLATE(table,keyvalue) (key, value)
          VALUES ({seq_key}, {seq_value});
  main-read:
    params:
      ratio: TEMPLATE(readratio,1)
      cl: LOCAL_ONE
      timeout: 10.0
    ops:
      main-select:
        type: prepared
        stmt: |
          SELECT key, value FROM TEMPLATE(keyspace,baselines).TEMPLATE(table,keyvalue)
          WHERE key = {rw_key};
  main-write:
    params:
      ratio: TEMPLATE(writeratio,1)
      cl: LOCAL_ONE
      timeout: 10.0
    ops:
      main-insert:
        type: prepared
        stmt: |
          INSERT INTO TEMPLATE(keyspace,baselines).TEMPLATE(table,keyvalue) (key, value)
          VALUES ({rw_key}, {rw_value});
